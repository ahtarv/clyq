{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"expo-secure-store","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":49,"index":49}}],"key":"BU2XtfznZ4PiVldqd/oueHCCaLo=","exportNames":["*"],"imports":1}},{"name":"expo/fetch","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":50},"end":{"line":2,"column":48,"index":98}}],"key":"ug2WTu871fxhwUkT+lg+x8TWZJo=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopNamespace(e) {\n    if (e && e.__esModule) return e;\n    var n = {};\n    if (e) Object.keys(e).forEach(function (k) {\n      n[k] = e[k];\n    });\n    n.default = e;\n    return n;\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  var _expoSecureStore = require(_dependencyMap[1], \"expo-secure-store\");\n  var SecureStore = _interopNamespace(_expoSecureStore);\n  var _expoFetch = require(_dependencyMap[2], \"expo/fetch\");\n  const originalFetch = fetch;\n  const authKey = `${_expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID}-jwt`;\n  const getURLFromArgs = (...args) => {\n    const [urlArg] = args;\n    let url;\n    if (typeof urlArg === 'string') {\n      url = urlArg;\n    } else if (typeof urlArg === 'object' && urlArg !== null) {\n      url = urlArg.url;\n    } else {\n      url = null;\n    }\n    return url;\n  };\n  const isFileURL = url => {\n    return url.startsWith('file://') || url.startsWith('data:');\n  };\n  const isFirstPartyURL = url => {\n    return url.startsWith('/') || _expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL && url.startsWith(_expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL);\n  };\n  const isSecondPartyURL = url => {\n    return url.startsWith('/_create/');\n  };\n  const fetchToWeb = async function fetchWithHeaders(...args) {\n    const firstPartyURL = _expoVirtualEnv.env.EXPO_PUBLIC_BASE_URL;\n    const secondPartyURL = _expoVirtualEnv.env.EXPO_PUBLIC_PROXY_BASE_URL;\n    const [input, init] = args;\n    const url = getURLFromArgs(input, init);\n    if (!url) {\n      return (0, _expoFetch.fetch)(input, init);\n    }\n    if (isFileURL(url)) {\n      return originalFetch(input, init);\n    }\n    const isExternalFetch = !isFirstPartyURL(url);\n    // we should not add headers to requests that don't go to our own server\n    if (isExternalFetch) {\n      return (0, _expoFetch.fetch)(input, init);\n    }\n    let finalInput = input;\n    const baseURL = isSecondPartyURL(url) ? secondPartyURL : firstPartyURL;\n    if (typeof input === 'string') {\n      finalInput = input.startsWith('/') ? `${baseURL}${input}` : input;\n    } else {\n      return (0, _expoFetch.fetch)(input, init);\n    }\n    const initHeaders = init?.headers ?? {};\n    const finalHeaders = new Headers(initHeaders);\n    const headers = {\n      'x-createxyz-project-group-id': _expoVirtualEnv.env.EXPO_PUBLIC_PROJECT_GROUP_ID,\n      host: _expoVirtualEnv.env.EXPO_PUBLIC_HOST,\n      'x-forwarded-host': _expoVirtualEnv.env.EXPO_PUBLIC_HOST,\n      'x-createxyz-host': _expoVirtualEnv.env.EXPO_PUBLIC_HOST\n    };\n    for (const [key, value] of Object.entries(headers)) {\n      if (value) {\n        finalHeaders.set(key, value);\n      }\n    }\n    const auth = await SecureStore.getItemAsync(authKey).then(auth => {\n      return auth ? JSON.parse(auth) : null;\n    }).catch(() => {\n      return null;\n    });\n    if (auth) {\n      finalHeaders.set('authorization', `Bearer ${auth.jwt}`);\n    }\n    return (0, _expoFetch.fetch)(finalInput, {\n      ...init,\n      headers: finalHeaders\n    });\n  };\n  var _default = fetchToWeb;\n});","lineCount":99,"map":[[16,2,97,0,"Object"],[16,8,97,0],[16,9,97,0,"defineProperty"],[16,23,97,0],[16,24,97,0,"exports"],[16,31,97,0],[17,4,97,0,"enumerable"],[17,14,97,0],[18,4,97,0,"get"],[18,7,97,0],[18,18,97,0,"get"],[18,19,97,0],[19,6,97,0],[19,13,97,0,"_default"],[19,21,97,0],[20,4,97,0],[21,2,97,0],[22,2,97,26],[22,6,97,26,"_expoVirtualEnv"],[22,21,97,26],[22,24,97,26,"require"],[22,31,97,26],[22,32,97,26,"_dependencyMap"],[22,46,97,26],[23,2,1,0],[23,6,1,0,"_expoSecureStore"],[23,22,1,0],[23,25,1,0,"require"],[23,32,1,0],[23,33,1,0,"_dependencyMap"],[23,47,1,0],[24,2,1,0],[24,6,1,0,"SecureStore"],[24,17,1,0],[24,20,1,0,"_interopNamespace"],[24,37,1,0],[24,38,1,0,"_expoSecureStore"],[24,54,1,0],[25,2,2,0],[25,6,2,0,"_expoFetch"],[25,16,2,0],[25,19,2,0,"require"],[25,26,2,0],[25,27,2,0,"_dependencyMap"],[25,41,2,0],[26,2,4,0],[26,8,4,6,"originalFetch"],[26,21,4,19],[26,24,4,22,"fetch"],[26,29,4,27],[27,2,5,0],[27,8,5,6,"authKey"],[27,15,5,13],[27,18,5,16],[27,21,5,16,"_expoVirtualEnv"],[27,36,5,16],[27,37,5,16,"env"],[27,40,5,16],[27,41,5,16,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[27,69,5,16],[27,75,5,65],[28,2,7,0],[28,8,7,6,"getURLFromArgs"],[28,22,7,20],[28,25,7,23,"getURLFromArgs"],[28,26,7,24],[28,29,7,27,"args"],[28,33,7,57],[28,38,7,62],[29,4,8,2],[29,10,8,8],[29,11,8,9,"urlArg"],[29,17,8,15],[29,18,8,16],[29,21,8,19,"args"],[29,25,8,23],[30,4,9,2],[30,8,9,6,"url"],[30,11,9,24],[31,4,10,2],[31,8,10,6],[31,15,10,13,"urlArg"],[31,21,10,19],[31,26,10,24],[31,34,10,32],[31,36,10,34],[32,6,11,4,"url"],[32,9,11,7],[32,12,11,10,"urlArg"],[32,18,11,16],[33,4,12,2],[33,5,12,3],[33,11,12,9],[33,15,12,13],[33,22,12,20,"urlArg"],[33,28,12,26],[33,33,12,31],[33,41,12,39],[33,45,12,43,"urlArg"],[33,51,12,49],[33,56,12,54],[33,60,12,58],[33,62,12,60],[34,6,13,4,"url"],[34,9,13,7],[34,12,13,10,"urlArg"],[34,18,13,16],[34,19,13,17,"url"],[34,22,13,20],[35,4,14,2],[35,5,14,3],[35,11,14,9],[36,6,15,4,"url"],[36,9,15,7],[36,12,15,10],[36,16,15,14],[37,4,16,2],[38,4,17,2],[38,11,17,9,"url"],[38,14,17,12],[39,2,18,0],[39,3,18,1],[40,2,20,0],[40,8,20,6,"isFileURL"],[40,17,20,15],[40,20,20,19,"url"],[40,23,20,30],[40,27,20,35],[41,4,21,2],[41,11,21,9,"url"],[41,14,21,12],[41,15,21,13,"startsWith"],[41,25,21,23],[41,26,21,24],[41,35,21,33],[41,36,21,34],[41,40,21,38,"url"],[41,43,21,41],[41,44,21,42,"startsWith"],[41,54,21,52],[41,55,21,53],[41,62,21,60],[41,63,21,61],[42,2,22,0],[42,3,22,1],[43,2,24,0],[43,8,24,6,"isFirstPartyURL"],[43,23,24,21],[43,26,24,25,"url"],[43,29,24,36],[43,33,24,41],[44,4,25,2],[44,11,26,4,"url"],[44,14,26,7],[44,15,26,8,"startsWith"],[44,25,26,18],[44,26,26,19],[44,29,26,22],[44,30,26,23],[44,34,27,5,"_expoVirtualEnv"],[44,49,27,5],[44,50,27,5,"env"],[44,53,27,5],[44,54,27,5,"EXPO_PUBLIC_BASE_URL"],[44,74,27,5],[44,78,27,41,"url"],[44,81,27,44],[44,82,27,45,"startsWith"],[44,92,27,55],[44,93,27,55,"_expoVirtualEnv"],[44,108,27,55],[44,109,27,55,"env"],[44,112,27,55],[44,113,27,55,"EXPO_PUBLIC_BASE_URL"],[44,133,27,88],[44,134,27,90],[45,2,29,0],[45,3,29,1],[46,2,31,0],[46,8,31,6,"isSecondPartyURL"],[46,24,31,22],[46,27,31,26,"url"],[46,30,31,37],[46,34,31,42],[47,4,32,2],[47,11,32,9,"url"],[47,14,32,12],[47,15,32,13,"startsWith"],[47,25,32,23],[47,26,32,24],[47,37,32,35],[47,38,32,36],[48,2,33,0],[48,3,33,1],[49,2,36,0],[49,8,36,6,"fetchToWeb"],[49,18,36,16],[49,21,36,19],[49,36,36,34,"fetchWithHeaders"],[49,52,36,50,"fetchWithHeaders"],[49,53,36,51],[49,56,36,54,"args"],[49,60,36,66],[49,62,36,68],[50,4,37,2],[50,10,37,8,"firstPartyURL"],[50,23,37,21],[50,26,37,21,"_expoVirtualEnv"],[50,41,37,21],[50,42,37,21,"env"],[50,45,37,21],[50,46,37,21,"EXPO_PUBLIC_BASE_URL"],[50,66,37,56],[51,4,38,2],[51,10,38,8,"secondPartyURL"],[51,24,38,22],[51,27,38,22,"_expoVirtualEnv"],[51,42,38,22],[51,43,38,22,"env"],[51,46,38,22],[51,47,38,22,"EXPO_PUBLIC_PROXY_BASE_URL"],[51,73,38,63],[52,4,39,2],[52,10,39,8],[52,11,39,9,"input"],[52,16,39,14],[52,18,39,16,"init"],[52,22,39,20],[52,23,39,21],[52,26,39,24,"args"],[52,30,39,28],[53,4,40,2],[53,10,40,8,"url"],[53,13,40,11],[53,16,40,14,"getURLFromArgs"],[53,30,40,28],[53,31,40,29,"input"],[53,36,40,34],[53,38,40,36,"init"],[53,42,40,40],[53,43,40,41],[54,4,41,2],[54,8,41,6],[54,9,41,7,"url"],[54,12,41,10],[54,14,41,12],[55,6,42,4],[55,13,42,11],[55,17,42,11,"expoFetch"],[55,27,42,20],[55,28,42,20,"fetch"],[55,33,42,20],[55,35,42,21,"input"],[55,40,42,26],[55,42,42,28,"init"],[55,46,42,32],[55,47,42,33],[56,4,43,2],[57,4,45,2],[57,8,45,6,"isFileURL"],[57,17,45,15],[57,18,45,16,"url"],[57,21,45,19],[57,22,45,20],[57,24,45,22],[58,6,46,4],[58,13,46,11,"originalFetch"],[58,26,46,24],[58,27,46,25,"input"],[58,32,46,30],[58,34,46,32,"init"],[58,38,46,36],[58,39,46,37],[59,4,47,2],[60,4,49,2],[60,10,49,8,"isExternalFetch"],[60,25,49,23],[60,28,49,26],[60,29,49,27,"isFirstPartyURL"],[60,44,49,42],[60,45,49,43,"url"],[60,48,49,46],[60,49,49,47],[61,4,50,2],[62,4,51,2],[62,8,51,6,"isExternalFetch"],[62,23,51,21],[62,25,51,23],[63,6,52,4],[63,13,52,11],[63,17,52,11,"expoFetch"],[63,27,52,20],[63,28,52,20,"fetch"],[63,33,52,20],[63,35,52,21,"input"],[63,40,52,26],[63,42,52,28,"init"],[63,46,52,32],[63,47,52,33],[64,4,53,2],[65,4,55,2],[65,8,55,6,"finalInput"],[65,18,55,16],[65,21,55,19,"input"],[65,26,55,24],[66,4,56,2],[66,10,56,8,"baseURL"],[66,17,56,15],[66,20,56,18,"isSecondPartyURL"],[66,36,56,34],[66,37,56,35,"url"],[66,40,56,38],[66,41,56,39],[66,44,56,42,"secondPartyURL"],[66,58,56,56],[66,61,56,59,"firstPartyURL"],[66,74,56,72],[67,4,57,2],[67,8,57,6],[67,15,57,13,"input"],[67,20,57,18],[67,25,57,23],[67,33,57,31],[67,35,57,33],[68,6,58,4,"finalInput"],[68,16,58,14],[68,19,58,17,"input"],[68,24,58,22],[68,25,58,23,"startsWith"],[68,35,58,33],[68,36,58,34],[68,39,58,37],[68,40,58,38],[68,43,58,41],[68,46,58,44,"baseURL"],[68,53,58,51],[68,56,58,54,"input"],[68,61,58,59],[68,63,58,61],[68,66,58,64,"input"],[68,71,58,69],[69,4,59,2],[69,5,59,3],[69,11,59,9],[70,6,60,4],[70,13,60,11],[70,17,60,11,"expoFetch"],[70,27,60,20],[70,28,60,20,"fetch"],[70,33,60,20],[70,35,60,21,"input"],[70,40,60,26],[70,42,60,28,"init"],[70,46,60,32],[70,47,60,33],[71,4,61,2],[72,4,63,2],[72,10,63,8,"initHeaders"],[72,21,63,19],[72,24,63,22,"init"],[72,28,63,26],[72,30,63,28,"headers"],[72,37,63,35],[72,41,63,39],[72,42,63,40],[72,43,63,41],[73,4,64,2],[73,10,64,8,"finalHeaders"],[73,22,64,20],[73,25,64,23],[73,29,64,27,"Headers"],[73,36,64,34],[73,37,64,35,"initHeaders"],[73,48,64,46],[73,49,64,47],[74,4,66,2],[74,10,66,8,"headers"],[74,17,66,15],[74,20,66,18],[75,6,67,4],[75,36,67,34],[75,38,67,34,"_expoVirtualEnv"],[75,53,67,34],[75,54,67,34,"env"],[75,57,67,34],[75,58,67,34,"EXPO_PUBLIC_PROJECT_GROUP_ID"],[75,86,67,76],[76,6,68,4,"host"],[76,10,68,8],[76,12,68,8,"_expoVirtualEnv"],[76,27,68,8],[76,28,68,8,"env"],[76,31,68,8],[76,32,68,8,"EXPO_PUBLIC_HOST"],[76,48,68,38],[77,6,69,4],[77,24,69,22],[77,26,69,22,"_expoVirtualEnv"],[77,41,69,22],[77,42,69,22,"env"],[77,45,69,22],[77,46,69,22,"EXPO_PUBLIC_HOST"],[77,62,69,52],[78,6,70,4],[78,24,70,22],[78,26,70,22,"_expoVirtualEnv"],[78,41,70,22],[78,42,70,22,"env"],[78,45,70,22],[78,46,70,22,"EXPO_PUBLIC_HOST"],[79,4,71,2],[79,5,71,3],[80,4,73,2],[80,9,73,7],[80,15,73,13],[80,16,73,14,"key"],[80,19,73,17],[80,21,73,19,"value"],[80,26,73,24],[80,27,73,25],[80,31,73,29,"Object"],[80,37,73,35],[80,38,73,36,"entries"],[80,45,73,43],[80,46,73,44,"headers"],[80,53,73,51],[80,54,73,52],[80,56,73,54],[81,6,74,4],[81,10,74,8,"value"],[81,15,74,13],[81,17,74,15],[82,8,75,6,"finalHeaders"],[82,20,75,18],[82,21,75,19,"set"],[82,24,75,22],[82,25,75,23,"key"],[82,28,75,26],[82,30,75,28,"value"],[82,35,75,33],[82,36,75,34],[83,6,76,4],[84,4,77,2],[85,4,79,2],[85,10,79,8,"auth"],[85,14,79,12],[85,17,79,15],[85,23,79,21,"SecureStore"],[85,34,79,32],[85,35,79,33,"getItemAsync"],[85,47,79,45],[85,48,79,46,"authKey"],[85,55,79,53],[85,56,79,54],[85,57,80,5,"then"],[85,61,80,9],[85,62,80,11,"auth"],[85,66,80,15],[85,70,80,20],[86,6,81,6],[86,13,81,13,"auth"],[86,17,81,17],[86,20,81,20,"JSON"],[86,24,81,24],[86,25,81,25,"parse"],[86,30,81,30],[86,31,81,31,"auth"],[86,35,81,35],[86,36,81,36],[86,39,81,39],[86,43,81,43],[87,4,82,4],[87,5,82,5],[87,6,82,6],[87,7,83,5,"catch"],[87,12,83,10],[87,13,83,11],[87,19,83,17],[88,6,84,6],[88,13,84,13],[88,17,84,17],[89,4,85,4],[89,5,85,5],[89,6,85,6],[90,4,87,2],[90,8,87,6,"auth"],[90,12,87,10],[90,14,87,12],[91,6,88,4,"finalHeaders"],[91,18,88,16],[91,19,88,17,"set"],[91,22,88,20],[91,23,88,21],[91,38,88,36],[91,40,88,38],[91,50,88,48,"auth"],[91,54,88,52],[91,55,88,53,"jwt"],[91,58,88,56],[91,60,88,58],[91,61,88,59],[92,4,89,2],[93,4,91,2],[93,11,91,9],[93,15,91,9,"expoFetch"],[93,25,91,18],[93,26,91,18,"fetch"],[93,31,91,18],[93,33,91,19,"finalInput"],[93,43,91,29],[93,45,91,31],[94,6,92,4],[94,9,92,7,"init"],[94,13,92,11],[95,6,93,4,"headers"],[95,13,93,11],[95,15,93,13,"finalHeaders"],[96,4,94,2],[96,5,94,3],[96,6,94,4],[97,2,95,0],[97,3,95,1],[98,2,97,0],[98,6,97,0,"_default"],[98,14,97,0],[98,17,97,15,"fetchToWeb"],[98,27,97,25],[99,0,97,26],[99,3]],"functionMap":{"names":["<global>","getURLFromArgs","isFileURL","isFirstPartyURL","isSecondPartyURL","fetchWithHeaders","SecureStore.getItemAsync.then$argument_0","SecureStore.getItemAsync.then._catch$argument_0"],"mappings":"AAA;uBCM;CDW;kBEE;CFE;wBGE;CHK;yBIE;CJE;mBKG;UC4C;KDE;WEC;KFE;CLU"},"hasCjsExports":false},"type":"js/module"}]}